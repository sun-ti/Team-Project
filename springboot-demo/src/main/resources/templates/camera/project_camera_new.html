<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">

		<meta name="renderer" content="webkit">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
		<link rel="stylesheet" href="layui/css/layui.css" media="all">

	</head>

	<body>
		<fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">

		</fieldset>

<!--		<div class="layui-row" style="width: 1000">

			<div class="demoTable">
				请输入设备型号进行搜索：
				<div class="layui-inline">
					<input name="id" class="layui-input" id="demoReload" autocomplete="off">
				</div>
				<button class="layui-btn" data-type="reload">搜索</button>
			</div>
		</div>-->
		<table class="layui-hide" id="LAY_table_user" lay-filter="user"></table>
		<script type="text/html" id="monitorinfoTool">
			<a class="layui-btn layui-btn-xs" lay-event="image1View">查看照片1</a>

		</script>
		<script src="layui/layui.js" charset="utf-8"></script>

		<script>
			layui.use(['table', 'carousel'], function() {
				var table = layui.table;
				var carousel = layui.carousel;
				//方法级渲染
				table.render({
					elem: '#LAY_table_user',
					url: '/demo/table/user/',
					cols: [
						[{
								checkbox: true,
								fixed: true
							}, {
								field: 'number',
								title: '序号',
								sort: true,
								width: 80
							}, {
								field: 'id',
								title: '设备型号',
								sort: true,
								fixed: true
							}, {
								field: 'name',
								title: '设备名称'
							}, {
								field: 'situation',
								title: '安装位置'
							}, {
								field: 'fiction',
								title: '实现功能'
							}, {
								field: 'transation',
								title: '传输数据结构'
							}, {
								fixed: 'right',
								title: '设备图片',
								align: 'center',
								toolbar: '#monitorinfoTool'
							}

						]
					],
					id: 'testReload',
					page: true,
					height: 310
				});

			/*	var $ = layui.$,
					active = {
						reload: function() {
							var demoReload = $('#demoReload');

							//执行重载
							table.reload('testReload', {
								page: {
									curr: 1 //重新从第 1 页开始
								},
								where: {
									key: {
										id: demoReload.val()
									}
								}
							}, 'data');
						}
					};

				$('.demoTable .layui-btn').on('click', function() {
					var type = $(this).data('type');
					active[type] ? active[type].call(this) : '';
				});*/
				table.on('tool(table)', function(obj) {
					var data = obj.data;
					var layEvent = obj.event;
					var tr = obj.tr;
					var layer = layui.layer;

					var image1HTML = '<img style="height:280px;width:600px" src="' + data['pic1'] + '"/>';
					var image2HTML = '<img style="height:280px;width:600px" src="' + data['pic2'] + '"/>';

					var content = '<div class="layui-carousel" id="imageView" style="background: transparent"><div carousel-item>' +
						'<div style="background: transparent">' + image1HTML + '</div>' +
						'<div style="background: transparent">' + image2HTML + '</div>' +
						'</div></div>';

					var initImgIndex; // 默认图片
					if(layEvent === 'image1View') {
						initImgIndex = 0;
					} else if(layEvent === 'image2View') {
						initImgIndex = 1;
					} else if(layEvent === 'msgView') {
						content = '<div style="padding: 10px"><p>' + obj.data['errMsg'] + '</p></div>'
					}
					layer.open({
						type: 1,
						offset: ['100px', '200px']
							// , shade: 0
							,
						shadeClose: true,
						title: false,
						content: content,
						index: initImgIndex,
						success: function(layero, index) {
							layer.style(index, {
								background: 'transparent'
							});
							carousel.render({
								elem: '#imageView'
									// , width: '400px'
									// , height: '400px'
									,
								arrow: 'always',
								autoplay: false
								// , indicator: 'outside'
							});
						}
					});
				})

			});
		</script>

	</body>

</html>